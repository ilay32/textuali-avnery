<!DOCTYPE html>
<!--[if lt IE 7 ]> <html lang="he" class="ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="he" class="ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="he" class="ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="he" class="ie9"> <![endif]-->
<!--[if !IE]><!-->

<html lang="he">
<!--<![endif]-->

<head>
  <meta name="generator" content=
  "HTML Tidy for Linux (vers 25 March 2009), see www.w3.org">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"><!--
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable = no" />
-->
  <meta name="viewport" content="width = 1050, user-scalable = no">
  <!--
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../favicon.ico">
-->

  <title>Avnery flipbook test</title><!-- Bootstrap core CSS -->
  <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet"
  type="text/css">
  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
      <script src="html5shiv.min.js"></script>
      <script src="respond.min.js"></script>
    <![endif]-->
   
  <script src="../vendor/turnjs4/lib/hash.js" type="text/javascript"></script>

  <style type="text/css">
    body { padding-top: 50px }
      .hidden { display:none }
      .page-html {
        padding: 40px 1em 0; 
      }
      .page-html iframe {
        width:100%;
        border:none;
        background:white
       }
      .page.odd { text-align:right }
      .page.even { text-align:left }
  </style>
</head>

<body>
  <!--
    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Project name</a>
        </div>
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="#about">About</a></li>
            <li><a href="#contact">Contact</a></li>
          </ul>
        </div>
      </div>
    </div>
-->

    <div class="container" style="direction:rtl">
        <div class="row">
            <div class="col-md-12 text-center" >
                <div class="btn-group btn-group-xs">
                     <button title="show scan image of pages" type="button" id="showscans" class="btn btn-default mode-toggle" >
                        <span class="glyphicon glyphicon-picture"></span>
                     </button>
                     <button title="zoom in" type="button" id="enlarge" class="btn btn-default" >
                        <span class="glyphicon glyphicon-resize-full"></span>
                     </button>
                     <button title="show pages as text" type="button" id="showhtmls" class="btn btn-default mode-toggle">
                        <span class="glyphicon glyphicon-font"></span>
                     </button>
                </div>
                <div class="btn-group btn-group-xs">
                    <button title="next page" type="button" class="btn btn-default" id="flb-next">
                        <span class="glyphicon glyphicon-chevron-left"></span>
                    </button>
                    <button title="go to table of contents page" type="button" class="btn btn-default" id="totoc">
                        <span class="glyphicon glyphicon-list"></span>
                    </button>
                    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                        <span class="caret"></span> :go to
                    </button>
                    <button title="previous page" type="button" class="btn btn-default" id="flb-prev">
                        <span class="glyphicon glyphicon-chevron-right"/>
                    </button>
                    <ul class="dropdown-menu" role="menu" id="gotopage"></ul>
                </div>
                <div class="btn-group btn-group-xs">
                    <button title="download pdf" type="button" class="btn btn-default" id="download-pdf">
                        <span class="glyphicon glyphicon-download-alt"></span>
                    </button>
                    <button title="tag cloud" type="button" class="btn btn-default" id="tag-cloud">
                        <span class="glyphicon glyphicon-cloud"></span>
                    </button>
                    <button title="share this book" type="button" class="btn btn-default" id="share">
                        <span class="glyphicon glyphicon-transfer"></span>
                    </button>        
                </div>
                <div class="btn-group btn-group-xs">
                    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                        <span class="glyphicon glyphicon-search"></span>
                    </button>
                    <button title="previous menu" type="button" class="btn btn-default" id="flb-prev">
                        previous menu?
                    </button>   
                    <div class="dropdown-menu">
                        <input type="text" class="form-control" placeholder="search">
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div id="flipbook-wrapper" class="col-md-12 text-center">
                <div class="flipbook-viewport">
                    <div class="flipbook-container">
                        <div class="flipbook">
                            <div class="hard" style="background-image:url(../scans/avnery/777_front.jpg); background-size: contain"></div>
                            <div class="hard" style="background-image:url(../scans/avnery/777_front_inner.jpg); background-size: contain"></div>
                            <div style="background-image:url(../scans/avnery/777_page_0001.jpg); background-size: contain">
                                <div class="spine-gradient"></div>
                            </div>

                            <div style="background-image:url(../scans/avnery/777_page_0002.jpg); background-size: contain">
                                <div class="spine-gradient"></div>
                            </div>

                            <div style="background-image:url(../scans/avnery/777_page_0005.jpg); background-size: contain">
                                <div class="spine-gradient">
                                    <div class="page-html hidden">
                                        <iframe src="html-pages/b001p000g.htm"></iframe>
                                    </div>
                                </div>
                            </div>

                            <div style="background-image:url(../scans/avnery/777_page_0006.jpg); background-size: contain">
                                <div class="spine-gradient">
                                    <div class="page-html hidden">
                                        <iframe src="html-pages/b001p000h.htm"></iframe>
                                    </div>
                                </div>
                            </div>

                            <div style="background-image:url(../scans/avnery/777_page_0015.jpg); background-size: contain">
                                <div class="spine-gradient">
                                    <div class="page-html hidden">
                                        <iframe src="html-pages/b001p009.htm"></iframe>
                                    </div>
                                </div>
                            </div>

                            <div style="background-image:url(../scans/avnery/777_page_0016.jpg); background-size: contain">
                                <div class="spine-gradient">
                                    <div class="page-html hidden">
                                        <iframe src="html-pages/b001p010.htm"></iframe>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="hard" style="background-image:url(../scans/avnery/777_back_inner.jpg); background-size: contain"></div>
                            <div class="hard" style="background-image:url(../scans/avnery/777_back.jpg); background-size: contain"></div>
                        </div><!-- flipbook -->
                    </div>
                </div><!--flipbook-viewport -->
            </div>
        </div><!-- .row -->
    </div><!-- .container -->
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="js/jquery-1.11.1.js" type="text/javascript"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="js/ie10-viewport-bug-workaround.js" type="text/javascript"></script>
    <script type="text/javascript" src="../vendor/turnjs4/extras/modernizr.2.5.3.min.js" type="text/javascript"></script>
    <script src="js/bootstrap.min.js" type="text/javascript"></script> 
    <script type="text/javascript">
        $('.flipbook').data('displayMode', 'scan');
        $('#enlarge').click(function() {
            var z = $('.flipbook').turn('zoom');
            if(z > 1) {
                $('.flipbook').turn('zoom', 1);
                $(this).find('span').removeClass('glyphicon-resize-small').addClass('glyphicon-resize-full');
                $(this).attr('title', 'zoom in');
            }
            else {
                $('.flipbook').turn('zoom', 1.5);
                $(this).find('span').removeClass('glyphicon-resize-full').addClass('glyphicon-resize-small');
                $(this).attr('title', 'zoom out');
            }
        });
        
        $('#flb-next').click(function() {
            $('.flipbook').turn('next');
        });
        
        $('#flb-prev').click(function() {
            $('.flipbook').turn('previous');
        });
        
        $('.mode-toggle').click(function() {
            var d=$('.flipbook').data();
            if(this.id == 'showhtmls' && d.displayMode == 'scan')  {
                d.displayMode = 'html';
           }
           else if(this.id == 'showscans' && d.displayMode == 'html') {
                d.displayMode = 'scan';
           }
           toggleHtml($('.flipbook').turn('view'));
        });
        
        $('#totoc').click(function() {
            $('.flipbook').turn('page',4);
        });
      
        function toggle_html(btn) {
            $(btn).parent().parent().find('iframe').each(function() {
                $(this).css('height',($(this).parent().parent().height()-80)+'px');
                $(this).parent().toggleClass('hidden');
            });
        }
        
        function show_html(pages) {
            var tar; 
            for (i in pages) {
                tar = find_html_div(pages[i]).add('.page-html');
                tar.each(function() {
                    $(this).removeClass('hidden').find('iframe').css('height',($(this).closest('.page-wrapper').height()-80)+'px');
                });
            }
        }
        
        function hide_html(pages) {
            for (i in pages) {
                find_html_div(pages[i]).add('.page-html').addClass('hidden');
            }
        }    
       
        function find_html_div(n) {
            return $('.page.p'+n).find('.page-html');
        }
        
        function toggleHtml(pages) {
            var displayMode = $('.flipbook').data('displayMode');
            if(displayMode == 'scan') {
                hide_html(pages);
            }
            else if(displayMode == 'html') {
                show_html(pages);
            }
        }
        
        function loadApp() {
            // Create the flipbook
            var book_height=Math.floor($(document).height()*0.9);
            var book_width=Math.floor(book_height*2*1024.0/1628.0);
            
            $('.flipbook').turn({
                width:book_width,
                height:book_height,
                elevation: 50,
                duration:2000,
                direction: "rtl",
                // Enable gradients
                gradients: true,
                // Auto center this flipbook
                autoCenter: true,
                when: {
                    'turned': function(event, page, pages) {
                        if(Hash.fragment() != '' || page != 1) {
                            Hash.go('page/'+page);
                        }
                     },
                     'start' : function(event,pageObject,corner) {
                        toggleHtml(pageObject.turn.turn('view'));                        
                    }
                }
            });
 
            for(var i=1;i<$('.flipbook').turn('pages');i++) {
                $('#gotopage').append('<li><a href="'+Hash.get('page/'+i)+'">page '+i+'</a></li>');
            }

            // URIs
            Hash.on('^page\/([0-9]*)$', {
                yep: function(path, parts) {
                    var page = parts[1];
                    if (page!==undefined) {
                        if ($('.flipbook').turn('is'))
                            $('.flipbook').turn('page', page);
                    }
                },
                nop: function(path) {
                    if ($('.flipbook').turn('is'))
                        $('.flipbook').turn('page', 2);
                }
            });

            // Arrows
            $(document).keydown(function(e){
                var previous = 37, next = 39;
                switch (e.keyCode) {
                    case previous:
                        $('.flipbook').turn('previous');
                    break;
                    case next:
                        $('.flipbook').turn('next');
                    break;
                }
            });
        } // loadApp
        
        // Load the HTML4 version if there's not CSS transform
        $(function() {
            yepnope({
                test : Modernizr.csstransforms,
                yep: ['../vendor/turnjs4/lib/turn.js'],
                nope: ['../vendor/turnjs4/lib/turn.html4.min.js'],
                both: ['css/responsive.css'],
                complete: loadApp
            });
        });      
  </script>
</body>
</html>
